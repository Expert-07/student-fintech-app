import{r as e,j as t}from"./index-CuiuqRSO.js";const a=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],s=["07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00"],l=()=>{const[l,r]=e.useState([]),[d,o]=e.useState(!0),[c,n]=e.useState(!1),[i,m]=e.useState(""),x=e.useRef(),h=async()=>{o(!0);const e=localStorage.getItem("token"),t=localStorage.getItem("userId");try{const a=await fetch(`http://localhost:5000/api/timetable/${t}`,{headers:{Authorization:`Bearer ${e}`}}),s=await a.json();r(s||[])}catch{r([])}o(!1)};e.useEffect(()=>{h()},[]);return t.jsxs("div",{className:"max-w-5xl mx-auto p-4",children:[t.jsx("h2",{className:"text-2xl font-bold mb-6 text-center",children:"Weekly Timetable"}),t.jsxs("div",{className:"mb-6 flex flex-col items-center",children:[t.jsx("label",{className:"mb-2 font-medium",children:"Upload Timetable as PDF:"}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"file",accept:"application/pdf",onChange:async e=>{const t=e.target.files[0];if(!t)return;if("application/pdf"!==t.type)return void m("Only PDF files are allowed.");n(!0),m("");const a=localStorage.getItem("token"),s=localStorage.getItem("userId"),l=new FormData;l.append("pdf",t),l.append("userId",s);try{const e=await fetch("http://localhost:5000/api/timetable/upload",{method:"POST",headers:{Authorization:`Bearer ${a}`},body:l}),t=await e.json();if(!e.ok)throw new Error(t.message||"Upload failed");alert("PDF uploaded successfully!")}catch(r){m(r.message)}finally{n(!1),x.current&&(x.current.value="")}},ref:x,className:"mb-2",disabled:c}),t.jsx("button",{type:"button",onClick:()=>{x.current&&(x.current.value=""),m("")},className:"mb-2 px-2 py-1 rounded-full bg-gray-200 hover:bg-gray-300 text-gray-600 text-lg font-bold focus:outline-none",title:"Clear file input",disabled:c,style:{lineHeight:1},children:"Ã—"})]}),c&&t.jsx("span",{className:"text-blue-500",children:"Uploading..."}),i&&t.jsx("span",{className:"text-red-500",children:i})]}),d?t.jsx("p",{className:"text-center",children:"Loading timetable..."}):t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full border-collapse",children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{className:"p-2 border bg-gray-100 dark:bg-[#1E293B]"}),a.map(e=>t.jsx("th",{className:"p-2 border bg-gray-100 dark:bg-[#1E293B] text-xs md:text-base",children:e},e))]})}),t.jsx("tbody",{children:s.map(e=>t.jsxs("tr",{children:[t.jsx("td",{className:"p-2 border bg-gray-50 dark:bg-[#1E293B] text-xs md:text-base font-semibold",children:e}),a.map(s=>{const r=((e,t)=>l.find(s=>("string"==typeof s.day_of_the_week?s.day_of_the_week:a[s.day_of_the_week])===e&&s.start_time.slice(0,5)===t))(s,e);return t.jsx("td",{className:"p-1 md:p-2 border align-top",children:r?t.jsxs("div",{className:"bg-blue-100 dark:bg-blue-900 rounded p-1 md:p-2 text-xs md:text-sm shadow",children:[t.jsx("div",{className:"font-bold",children:r.course_name||r.activity}),t.jsxs("div",{children:[r.start_time," - ",r.end_time]}),r.location&&t.jsx("div",{className:"text-gray-500",children:r.location}),r.lecturer&&t.jsxs("div",{className:"text-gray-400 text-xs",children:["Lecturer: ",r.lecturer]}),t.jsx("button",{onClick:()=>(async e=>{const t=localStorage.getItem("token");try{if(!(await fetch(`http://localhost:5000/api/timetable/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${t}`}})).ok)throw new Error("Failed to delete");h()}catch(a){console.error(a)}})(r.id),className:"text-red-400 text-xs",children:"Delete"})]}):null},s+e)})]},e))})]})})]})};export{l as default};
//# sourceMappingURL=Timetable-0Xyed43L.js.map
